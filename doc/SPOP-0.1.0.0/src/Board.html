<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : Board
Description : Game checkerboard.

The file includes game chackerboard datatype, represented as Map from Board.Coorinates to Board.Field. It also includes functions to update the board and AI to apply moves automatically. 

-}</span><span></span><span>
</span><a name="line-8"></a><span></span><span>
</span><a name="line-9"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Board</span><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-10"></a><span></span><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span>           </span><a href="Board.Coordinate.html"><span class="hs-identifier">Board</span><span class="hs-operator">.</span><span class="hs-identifier">Coordinate</span></a><span></span><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span>           </span><a href="Board.Field.html"><span class="hs-identifier">Board</span><span class="hs-operator">.</span><span class="hs-identifier">Field</span></a><span></span><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Conduit</span><span></span><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Aeson</span><span></span><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">ByteString</span><span class="hs-operator">.</span><span class="hs-identifier">Lazy</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">ByteString</span><span></span><span>
</span><a name="line-16"></a><span class="hs-comment">--import qualified Data.ByteString.Builder as Builder</span><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">ByteString</span><span class="hs-operator">.</span><span class="hs-identifier">Char8</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">BC</span><span></span><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Char</span><span></span><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span></span><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Map</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span></span><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span><span></span><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">Generics</span><span></span><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span>           </span><a href="Move.html"><span class="hs-identifier">Move</span></a><span></span><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span>           </span><a href="Move.Status.html"><span class="hs-identifier">Move</span><span class="hs-operator">.</span><span class="hs-identifier">Status</span></a><span></span><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span>           </span><a href="Move.Direction.html"><span class="hs-identifier">Move</span><span class="hs-operator">.</span><span class="hs-identifier">Direction</span></a><span></span><span>
</span><a name="line-26"></a><span></span><span>
</span><a name="line-27"></a><span class="hs-comment">-- | Error message, displayed if initial position of the wolf is not in the range 1..4. </span><span>
</span><a name="line-28"></a><span class="hs-identifier">invalidWolfPosition</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span></span><span>
</span><a name="line-29"></a><a name="invalidWolfPosition"><a href="Board.html#invalidWolfPosition"><span class="hs-identifier">invalidWolfPosition</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Wolf position must be integer in range 1..4&quot;</span><span> </span><span>
</span><a name="line-30"></a><span></span><span>
</span><a name="line-31"></a><span class="hs-comment">-- | Checkerboard datatype</span><span>
</span><a name="line-32"></a><span class="hs-keyword">newtype</span><span> </span><a name="Board"><a href="Board.html#Board"><span class="hs-identifier">Board</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Board"><a href="Board.html#Board"><span class="hs-identifier">Board</span></a></a><span> </span><span class="hs-special">{</span><span></span><span>
</span><a name="line-33"></a><span>    </span><a name="board"><a href="Board.html#board"><span class="hs-identifier">board</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Map</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Map</span><span> </span><a href="Board.Coordinate.html#Coordinate"><span class="hs-identifier hs-type">Coordinate</span></a><span> </span><a href="Board.Field.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><span class="hs-comment">-- ^ Map from Board.Coordinate to Board.Field</span><span>
</span><a name="line-34"></a><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-35"></a><span></span><span>
</span><a name="line-36"></a><span class="hs-comment">-- | Print the board on the screen, line by line, with fields coordinates and with boundaries. </span><span>
</span><a name="line-37"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Board.html#Board"><span class="hs-identifier hs-type">Board</span></a><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-38"></a><span>    </span><a name="local-8214565720323793864"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="Board.html#Board"><span class="hs-identifier hs-var">Board</span></a><span> </span><a name="local-6989586621679097195"><a href="#local-6989586621679097195"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><a name="line-39"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679097196"><a href="#local-6989586621679097196"><span class="hs-identifier">upperLine</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;    -----------------&quot;</span><span></span><span>
</span><a name="line-40"></a><span>            </span><a name="local-6989586621679097197"><a href="#local-6989586621679097197"><span class="hs-identifier">line0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;     &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;A B C D E F G H&quot;</span><span></span><span>
</span><a name="line-41"></a><span>            </span><a name="local-6989586621679097198"><a href="#local-6989586621679097198"><span class="hs-identifier">line1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot; 1 | &quot;</span><span>   </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;   &quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">intercalate</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097195"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.!</span><span> </span><a href="Board.Coordinate.html#A1"><span class="hs-identifier hs-var">A1</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097195"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.!</span><span> </span><a href="Board.Coordinate.html#C1"><span class="hs-identifier hs-var">C1</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097195"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.!</span><span> </span><a href="Board.Coordinate.html#E1"><span class="hs-identifier hs-var">E1</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097195"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.!</span><span> </span><a href="Board.Coordinate.html#G1"><span class="hs-identifier hs-var">G1</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;   |&quot;</span><span></span><span>
</span><a name="line-42"></a><span>            </span><a name="local-6989586621679097199"><a href="#local-6989586621679097199"><span class="hs-identifier">line2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot; 2 |   &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;   &quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">intercalate</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097195"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.!</span><span> </span><a href="Board.Coordinate.html#B2"><span class="hs-identifier hs-var">B2</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097195"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.!</span><span> </span><a href="Board.Coordinate.html#D2"><span class="hs-identifier hs-var">D2</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097195"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.!</span><span> </span><a href="Board.Coordinate.html#F2"><span class="hs-identifier hs-var">F2</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097195"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.!</span><span> </span><a href="Board.Coordinate.html#H2"><span class="hs-identifier hs-var">H2</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; |&quot;</span><span></span><span>
</span><a name="line-43"></a><span>            </span><a name="local-6989586621679097200"><a href="#local-6989586621679097200"><span class="hs-identifier">line3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot; 3 | &quot;</span><span>   </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;   &quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">intercalate</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097195"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.!</span><span> </span><a href="Board.Coordinate.html#A3"><span class="hs-identifier hs-var">A3</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097195"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.!</span><span> </span><a href="Board.Coordinate.html#C3"><span class="hs-identifier hs-var">C3</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097195"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.!</span><span> </span><a href="Board.Coordinate.html#E3"><span class="hs-identifier hs-var">E3</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097195"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.!</span><span> </span><a href="Board.Coordinate.html#G3"><span class="hs-identifier hs-var">G3</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;   |&quot;</span><span></span><span>
</span><a name="line-44"></a><span>            </span><a name="local-6989586621679097201"><a href="#local-6989586621679097201"><span class="hs-identifier">line4</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot; 4 |   &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;   &quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">intercalate</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097195"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.!</span><span> </span><a href="Board.Coordinate.html#B4"><span class="hs-identifier hs-var">B4</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097195"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.!</span><span> </span><a href="Board.Coordinate.html#D4"><span class="hs-identifier hs-var">D4</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097195"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.!</span><span> </span><a href="Board.Coordinate.html#F4"><span class="hs-identifier hs-var">F4</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097195"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.!</span><span> </span><a href="Board.Coordinate.html#H4"><span class="hs-identifier hs-var">H4</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; |&quot;</span><span></span><span>
</span><a name="line-45"></a><span>            </span><a name="local-6989586621679097202"><a href="#local-6989586621679097202"><span class="hs-identifier">line5</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot; 5 | &quot;</span><span>   </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;   &quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">intercalate</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097195"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.!</span><span> </span><a href="Board.Coordinate.html#A5"><span class="hs-identifier hs-var">A5</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097195"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.!</span><span> </span><a href="Board.Coordinate.html#C5"><span class="hs-identifier hs-var">C5</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097195"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.!</span><span> </span><a href="Board.Coordinate.html#E5"><span class="hs-identifier hs-var">E5</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097195"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.!</span><span> </span><a href="Board.Coordinate.html#G5"><span class="hs-identifier hs-var">G5</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;   |&quot;</span><span></span><span>
</span><a name="line-46"></a><span>            </span><a name="local-6989586621679097203"><a href="#local-6989586621679097203"><span class="hs-identifier">line6</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot; 6 |   &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;   &quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">intercalate</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097195"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.!</span><span> </span><a href="Board.Coordinate.html#B6"><span class="hs-identifier hs-var">B6</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097195"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.!</span><span> </span><a href="Board.Coordinate.html#D6"><span class="hs-identifier hs-var">D6</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097195"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.!</span><span> </span><a href="Board.Coordinate.html#F6"><span class="hs-identifier hs-var">F6</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097195"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.!</span><span> </span><a href="Board.Coordinate.html#H6"><span class="hs-identifier hs-var">H6</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; |&quot;</span><span></span><span>
</span><a name="line-47"></a><span>            </span><a name="local-6989586621679097204"><a href="#local-6989586621679097204"><span class="hs-identifier">line7</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot; 7 | &quot;</span><span>   </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;   &quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">intercalate</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097195"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.!</span><span> </span><a href="Board.Coordinate.html#A7"><span class="hs-identifier hs-var">A7</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097195"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.!</span><span> </span><a href="Board.Coordinate.html#C7"><span class="hs-identifier hs-var">C7</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097195"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.!</span><span> </span><a href="Board.Coordinate.html#E7"><span class="hs-identifier hs-var">E7</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097195"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.!</span><span> </span><a href="Board.Coordinate.html#G7"><span class="hs-identifier hs-var">G7</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;   |&quot;</span><span></span><span>
</span><a name="line-48"></a><span>            </span><a name="local-6989586621679097205"><a href="#local-6989586621679097205"><span class="hs-identifier">line8</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot; 8 |   &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;   &quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">intercalate</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097195"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.!</span><span> </span><a href="Board.Coordinate.html#B8"><span class="hs-identifier hs-var">B8</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097195"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.!</span><span> </span><a href="Board.Coordinate.html#D8"><span class="hs-identifier hs-var">D8</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097195"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.!</span><span> </span><a href="Board.Coordinate.html#F8"><span class="hs-identifier hs-var">F8</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097195"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.!</span><span> </span><a href="Board.Coordinate.html#H8"><span class="hs-identifier hs-var">H8</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; |&quot;</span><span></span><span>
</span><a name="line-49"></a><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-string">&quot;\n&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679097197"><span class="hs-identifier hs-var">line0</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\n&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679097196"><span class="hs-identifier hs-var">upperLine</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\n&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679097198"><span class="hs-identifier hs-var">line1</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\n&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679097199"><span class="hs-identifier hs-var">line2</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\n&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679097200"><span class="hs-identifier hs-var">line3</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\n&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679097201"><span class="hs-identifier hs-var">line4</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\n&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679097202"><span class="hs-identifier hs-var">line5</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\n&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679097203"><span class="hs-identifier hs-var">line6</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\n&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679097204"><span class="hs-identifier hs-var">line7</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\n&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679097205"><span class="hs-identifier hs-var">line8</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\n&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679097196"><span class="hs-identifier hs-var">upperLine</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\n&quot;</span><span></span><span>
</span><a name="line-50"></a><span></span><span>
</span><a name="line-51"></a><span class="hs-comment">-- | Return a initial board to start the game. </span><span>
</span><a name="line-52"></a><span class="hs-identifier">init</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^ Initial wolf position. Must be positive integer from 1 to 4 and denotes wolf position on the first (upper) row of the board, from left to right. </span><span>
</span><a name="line-53"></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Board.html#Board"><span class="hs-identifier hs-type">Board</span></a><span> </span><span class="hs-comment">-- ^ Initial board state. </span><span>
</span><a name="line-54"></a><a name="init"><a href="Board.html#init"><span class="hs-identifier">init</span></a></a><span> </span><a name="local-6989586621679097341"><a href="#local-6989586621679097341"><span class="hs-identifier">wolfPos</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><a name="line-55"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679097342"><a href="#local-6989586621679097342"><span class="hs-identifier">wolfC</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679097341"><span class="hs-identifier hs-var">wolfPos</span></a><span> </span><span class="hs-keyword">of</span><span></span><span>
</span><a name="line-56"></a><span>            </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Board.Coordinate.html#A1"><span class="hs-identifier hs-var">A1</span></a><span></span><span>
</span><a name="line-57"></a><span>            </span><span class="hs-number">2</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Board.Coordinate.html#C1"><span class="hs-identifier hs-var">C1</span></a><span></span><span>
</span><a name="line-58"></a><span>            </span><span class="hs-number">3</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Board.Coordinate.html#E1"><span class="hs-identifier hs-var">E1</span></a><span></span><span>
</span><a name="line-59"></a><span>            </span><span class="hs-number">4</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Board.Coordinate.html#G1"><span class="hs-identifier hs-var">G1</span></a><span> </span><span>
</span><a name="line-60"></a><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><a href="Board.html#invalidWolfPosition"><span class="hs-identifier hs-var">invalidWolfPosition</span></a><span></span><span>
</span><a name="line-61"></a><span>        </span><a name="local-6989586621679097343"><a href="#local-6989586621679097343"><span class="hs-identifier">maplist</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679097344"><a href="#local-6989586621679097344"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679097344"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679097342"><span class="hs-identifier hs-var">wolfC</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097344"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><a href="Board.Field.html#Wolf"><span class="hs-identifier hs-var">Wolf</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-62"></a><span>                       </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679097344"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><a href="Board.Coordinate.html#B8"><span class="hs-identifier hs-var">B8</span></a><span class="hs-special">,</span><span> </span><a href="Board.Coordinate.html#D8"><span class="hs-identifier hs-var">D8</span></a><span class="hs-special">,</span><span> </span><a href="Board.Coordinate.html#F8"><span class="hs-identifier hs-var">F8</span></a><span class="hs-special">,</span><span> </span><a href="Board.Coordinate.html#H8"><span class="hs-identifier hs-var">H8</span></a><span class="hs-special">]</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097344"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><a href="Board.Field.html#Sheep"><span class="hs-identifier hs-var">Sheep</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-63"></a><span>                       </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097344"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><a href="Board.Field.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">[</span><a href="Board.Coordinate.html#A1"><span class="hs-identifier hs-var">A1</span></a><span> </span><span class="hs-glyph">..</span><span> </span><a href="Board.Coordinate.html#H8"><span class="hs-identifier hs-var">H8</span></a><span class="hs-special">]</span><span></span><span>
</span><a name="line-64"></a><span>    </span><span class="hs-keyword">in</span><span> </span><a href="Board.html#Board"><span class="hs-identifier hs-var">Board</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromList</span><span> </span><a href="#local-6989586621679097343"><span class="hs-identifier hs-var">maplist</span></a><span></span><span>
</span><a name="line-65"></a><span></span><span>
</span><a name="line-66"></a><span class="hs-comment">-- | Checks if given move is valid on the board or is invalid for some reason. </span><span>
</span><a name="line-67"></a><span class="hs-identifier">moveStatus</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Board.html#Board"><span class="hs-identifier hs-type">Board</span></a><span>  </span><span class="hs-comment">-- ^ Board state. </span><span>
</span><a name="line-68"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Move.html#Move"><span class="hs-identifier hs-type">Move</span></a><span>   </span><span class="hs-comment">-- ^ Move to check. </span><span>
</span><a name="line-69"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Move.Status.html#Status"><span class="hs-identifier hs-type">Status</span></a><span> </span><span class="hs-comment">-- ^ Move validity. </span><span>
</span><a name="line-70"></a><a name="moveStatus"><a href="Board.html#moveStatus"><span class="hs-identifier">moveStatus</span></a></a><span> </span><span class="hs-special">(</span><a href="Board.html#Board"><span class="hs-identifier hs-var">Board</span></a><span> </span><a name="local-6989586621679097345"><a href="#local-6989586621679097345"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Move.html#Move"><span class="hs-identifier hs-var">Move</span></a><span> </span><a name="local-6989586621679097346"><a href="#local-6989586621679097346"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679097347"><a href="#local-6989586621679097347"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-71"></a><span>       </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679097345"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.!</span><span> </span><a href="#local-6989586621679097346"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Board.Field.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Move.Status.html#NothingToMove"><span class="hs-identifier hs-var">NothingToMove</span></a><span></span><span>
</span><a name="line-72"></a><span>       </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679097346"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">`</span><a href="Board.Coordinate.html#move"><span class="hs-identifier hs-var">move</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679097347"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Board.Coordinate.html#OutOfBoard"><span class="hs-identifier hs-var">Board</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">Coordinate</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">OutOfBoard</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Move.Status.html#OutOfBoard"><span class="hs-identifier hs-var">Move</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">Status</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">OutOfBoard</span></a><span></span><span>
</span><a name="line-73"></a><span>       </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679097345"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.!</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097346"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">`</span><a href="Board.Coordinate.html#move"><span class="hs-identifier hs-var">move</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679097347"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="Board.Field.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Move.Status.html#DestinationNotEmpty"><span class="hs-identifier hs-var">DestinationNotEmpty</span></a><span></span><span>
</span><a name="line-74"></a><span>       </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679097345"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.!</span><span> </span><a href="#local-6989586621679097346"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Board.Field.html#Sheep"><span class="hs-identifier hs-var">Sheep</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Move.Direction.html#vaxis"><span class="hs-identifier hs-var">vaxis</span></a><span> </span><a href="#local-6989586621679097347"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Move.Direction.html#Down"><span class="hs-identifier hs-var">Down</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Move.Status.html#SheepCannotGoBack"><span class="hs-identifier hs-var">SheepCannotGoBack</span></a><span></span><span>
</span><a name="line-75"></a><span>       </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Move.Status.html#OK"><span class="hs-identifier hs-var">OK</span></a><span></span><span>
</span><a name="line-76"></a><span></span><span>
</span><a name="line-77"></a><span class="hs-comment">-- | Infix equivalent of 'moveStatus'. </span><span>
</span><a name="line-78"></a><span class="hs-special">(</span><span class="hs-operator">??</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Board.html#Board"><span class="hs-identifier hs-type">Board</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Move.html#Move"><span class="hs-identifier hs-type">Move</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Move.Status.html#Status"><span class="hs-identifier hs-type">Status</span></a><span></span><span>
</span><a name="line-79"></a><span class="hs-special">(</span><a name="%3F%3F"><a href="Board.html#%3F%3F"><span class="hs-operator">??</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Board.html#moveStatus"><span class="hs-identifier hs-var">moveStatus</span></a><span></span><span>
</span><a name="line-80"></a><span></span><span>
</span><a name="line-81"></a><span class="hs-comment">-- | Execute a move on a board. </span><span>
</span><a name="line-82"></a><span class="hs-identifier">apply</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Board.html#Board"><span class="hs-identifier hs-type">Board</span></a><span> </span><span class="hs-comment">-- ^ Initial board state. </span><span>
</span><a name="line-83"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Move.html#Move"><span class="hs-identifier hs-type">Move</span></a><span>  </span><span class="hs-comment">-- ^ Move to execute.</span><span>
</span><a name="line-84"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Board.html#Board"><span class="hs-identifier hs-type">Board</span></a><span> </span><span class="hs-comment">-- ^ New board state. </span><span>
</span><a name="line-85"></a><a name="apply"><a href="Board.html#apply"><span class="hs-identifier">apply</span></a></a><span> </span><a name="local-6989586621679097348"><a href="#local-6989586621679097348"><span class="hs-identifier">brd</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Board.html#Board"><span class="hs-identifier hs-var">Board</span></a><span> </span><a name="local-6989586621679097349"><a href="#local-6989586621679097349"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679097350"><a href="#local-6989586621679097350"><span class="hs-identifier">mv</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Move.html#Move"><span class="hs-identifier hs-var">Move</span></a><span> </span><a name="local-6989586621679097351"><a href="#local-6989586621679097351"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679097352"><a href="#local-6989586621679097352"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><a name="line-86"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679097353"><a href="#local-6989586621679097353"><span class="hs-identifier">movedActor</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679097349"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.!</span><span> </span><a href="#local-6989586621679097351"><span class="hs-identifier hs-var">s</span></a><span></span><span>
</span><a name="line-87"></a><span>        </span><a name="local-6989586621679097354"><a href="#local-6989586621679097354"><span class="hs-identifier">destination</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679097351"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="Board.Coordinate.html#%7C%3E%3E"><span class="hs-operator hs-var">|&gt;&gt;</span></a><span> </span><a href="#local-6989586621679097352"><span class="hs-identifier hs-var">d</span></a><span></span><span>
</span><a name="line-88"></a><span>        </span><a name="local-6989586621679097355"><a href="#local-6989586621679097355"><span class="hs-identifier">b2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">insert</span><span> </span><a href="#local-6989586621679097354"><span class="hs-identifier hs-var">destination</span></a><span> </span><a href="#local-6989586621679097353"><span class="hs-identifier hs-var">movedActor</span></a><span> </span><a href="#local-6989586621679097349"><span class="hs-identifier hs-var">b</span></a><span></span><span>
</span><a name="line-89"></a><span>        </span><a name="local-6989586621679097356"><a href="#local-6989586621679097356"><span class="hs-identifier">b3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">insert</span><span> </span><a href="#local-6989586621679097351"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="Board.Field.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span> </span><a href="#local-6989586621679097355"><span class="hs-identifier hs-var">b2</span></a><span></span><span>
</span><a name="line-90"></a><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679097348"><span class="hs-identifier hs-var">brd</span></a><span> </span><a href="Board.html#%3F%3F"><span class="hs-operator hs-var">??</span></a><span> </span><a href="#local-6989586621679097350"><span class="hs-identifier hs-var">mv</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Move.Status.html#OK"><span class="hs-identifier hs-var">OK</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="Board.html#Board"><span class="hs-identifier hs-var">Board</span></a><span> </span><a href="#local-6989586621679097356"><span class="hs-identifier hs-var">b3</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679097348"><span class="hs-identifier hs-var">brd</span></a><span></span><span>
</span><a name="line-91"></a><span></span><span>
</span><a name="line-92"></a><span class="hs-comment">-- | Infix equivalent of 'apply'. </span><span>
</span><a name="line-93"></a><span class="hs-special">(</span><span class="hs-operator">&gt;&gt;&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Board.html#Board"><span class="hs-identifier hs-type">Board</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Move.html#Move"><span class="hs-identifier hs-type">Move</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Board.html#Board"><span class="hs-identifier hs-type">Board</span></a><span></span><span>
</span><a name="line-94"></a><span class="hs-special">(</span><a name="%3E%3E%3E"><a href="Board.html#%3E%3E%3E"><span class="hs-operator">&gt;&gt;&gt;</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Board.html#apply"><span class="hs-identifier hs-var">apply</span></a><span></span><span>
</span><a name="line-95"></a><span></span><span>
</span><a name="line-96"></a><span class="hs-comment">-- | Return a wolf coordinates on the board. </span><span>
</span><a name="line-97"></a><span class="hs-identifier">wolfCoord</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Board.html#Board"><span class="hs-identifier hs-type">Board</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Board.Coordinate.html#Coordinate"><span class="hs-identifier hs-type">Coordinate</span></a><span></span><span>
</span><a name="line-98"></a><a name="wolfCoord"><a href="Board.html#wolfCoord"><span class="hs-identifier">wolfCoord</span></a></a><span> </span><span class="hs-special">(</span><a href="Board.html#Board"><span class="hs-identifier hs-var">Board</span></a><span> </span><a name="local-6989586621679097357"><a href="#local-6989586621679097357"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">toList</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Board.Field.html#Wolf"><span class="hs-identifier hs-var">Wolf</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">filter</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679097357"><span class="hs-identifier hs-var">b</span></a><span> </span><span>
</span><a name="line-99"></a><span></span><span>
</span><a name="line-100"></a><span class="hs-comment">-- | Return a list of sheep coordinates on the board. </span><span>
</span><a name="line-101"></a><span class="hs-identifier">sheepsCoords</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Board.html#Board"><span class="hs-identifier hs-type">Board</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Board.Coordinate.html#Coordinate"><span class="hs-identifier hs-type">Coordinate</span></a><span class="hs-special">]</span><span></span><span>
</span><a name="line-102"></a><a name="sheepsCoords"><a href="Board.html#sheepsCoords"><span class="hs-identifier">sheepsCoords</span></a></a><span> </span><span class="hs-special">(</span><a href="Board.html#Board"><span class="hs-identifier hs-var">Board</span></a><span> </span><a name="local-6989586621679097373"><a href="#local-6989586621679097373"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">toList</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span> </span><a href="Board.Field.html#Sheep"><span class="hs-identifier hs-var">Sheep</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">filter</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679097373"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-103"></a><span></span><span>
</span><a name="line-104"></a><span class="hs-comment">-- | List of moves of the wolf, that are valid in the current board state. </span><span>
</span><a name="line-105"></a><span class="hs-identifier">validWolfMoves</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Board.html#Board"><span class="hs-identifier hs-type">Board</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Move.html#Move"><span class="hs-identifier hs-type">Move</span></a><span class="hs-special">]</span><span></span><span>
</span><a name="line-106"></a><a name="validWolfMoves"><a href="Board.html#validWolfMoves"><span class="hs-identifier">validWolfMoves</span></a></a><span> </span><a name="local-6989586621679097374"><a href="#local-6989586621679097374"><span class="hs-identifier">brd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><a name="line-107"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679097375"><a href="#local-6989586621679097375"><span class="hs-identifier">possibleMoves</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Move.html#Move"><span class="hs-identifier hs-var">Move</span></a><span> </span><span class="hs-special">(</span><a href="Board.html#wolfCoord"><span class="hs-identifier hs-var">wolfCoord</span></a><span> </span><a href="#local-6989586621679097374"><span class="hs-identifier hs-var">brd</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">[</span><a href="Move.Direction.html#DownLeft"><span class="hs-identifier hs-var">DownLeft</span></a><span> </span><span class="hs-glyph">..</span><span> </span><a href="Move.Direction.html#UpRight"><span class="hs-identifier hs-var">UpRight</span></a><span class="hs-special">]</span><span></span><span>
</span><a name="line-108"></a><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679097376"><a href="#local-6989586621679097376"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679097374"><span class="hs-identifier hs-var">brd</span></a><span> </span><a href="Board.html#%3F%3F"><span class="hs-operator hs-var">??</span></a><span> </span><a href="#local-6989586621679097376"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Move.Status.html#OK"><span class="hs-identifier hs-var">OK</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">filter</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679097375"><span class="hs-identifier hs-var">possibleMoves</span></a><span></span><span>
</span><a name="line-109"></a><span></span><span>
</span><a name="line-110"></a><span class="hs-comment">-- | List of moves of the sheeps, that are valid in the current board state.  </span><span>
</span><a name="line-111"></a><span class="hs-identifier">validSheepsMoves</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Board.html#Board"><span class="hs-identifier hs-type">Board</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Move.html#Move"><span class="hs-identifier hs-type">Move</span></a><span class="hs-special">]</span><span></span><span>
</span><a name="line-112"></a><a name="validSheepsMoves"><a href="Board.html#validSheepsMoves"><span class="hs-identifier">validSheepsMoves</span></a></a><span> </span><a name="local-6989586621679097377"><a href="#local-6989586621679097377"><span class="hs-identifier">brd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><a name="line-113"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679097378"><a href="#local-6989586621679097378"><span class="hs-identifier">possibleMovesCombinations</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679097380"><a href="#local-6989586621679097380"><span class="hs-identifier">sp</span></a></a><span> </span><a name="local-6989586621679097381"><a href="#local-6989586621679097381"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097380"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679097381"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Board.html#sheepsCoords"><span class="hs-identifier hs-var">sheepsCoords</span></a><span> </span><a href="#local-6989586621679097377"><span class="hs-identifier hs-var">brd</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><span class="hs-special">[</span><a href="Move.Direction.html#UpLeft"><span class="hs-identifier hs-var">UpLeft</span></a><span> </span><span class="hs-glyph">..</span><span> </span><a href="Move.Direction.html#UpRight"><span class="hs-identifier hs-var">UpRight</span></a><span class="hs-special">]</span><span></span><span>
</span><a name="line-114"></a><span>        </span><a name="local-6989586621679097379"><a href="#local-6989586621679097379"><span class="hs-identifier">possibleMoves</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">uncurry</span><span> </span><a href="Move.html#Move"><span class="hs-identifier hs-var">Move</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679097378"><span class="hs-identifier hs-var">possibleMovesCombinations</span></a><span></span><span>
</span><a name="line-115"></a><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679097382"><a href="#local-6989586621679097382"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679097377"><span class="hs-identifier hs-var">brd</span></a><span> </span><a href="Board.html#%3F%3F"><span class="hs-operator hs-var">??</span></a><span> </span><a href="#local-6989586621679097382"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Move.Status.html#OK"><span class="hs-identifier hs-var">OK</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">filter</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679097379"><span class="hs-identifier hs-var">possibleMoves</span></a><span></span><span>
</span><a name="line-116"></a><span></span><span>
</span><a name="line-117"></a><span class="hs-comment">-- | Calculates points, that wolf can use to rate its current situation in the game. With more points, the wolf situation is considered better. This function can be used as heuristics in mini-max algorithm and the game tree. </span><span>
</span><a name="line-118"></a><span class="hs-comment">{-| Changing the formula has great impact on the result of the game. Currently, wolf points are calculated as @points = wolf distance from upper board edge + 2 * number of valid wolf moves + mean distance from wolf to sheeps@
-}</span><span></span><span>
</span><a name="line-120"></a><span class="hs-identifier">wolfPoints</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Board.html#Board"><span class="hs-identifier hs-type">Board</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span></span><span>
</span><a name="line-121"></a><a name="wolfPoints"><a href="Board.html#wolfPoints"><span class="hs-identifier">wolfPoints</span></a></a><span> </span><a name="local-6989586621679097383"><a href="#local-6989586621679097383"><span class="hs-identifier">brd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><a name="line-122"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679097384"><a href="#local-6989586621679097384"><span class="hs-identifier">wolfC</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Board.html#wolfCoord"><span class="hs-identifier hs-var">wolfCoord</span></a><span> </span><a href="#local-6989586621679097383"><span class="hs-identifier hs-var">brd</span></a><span></span><span>
</span><a name="line-123"></a><span>        </span><a name="local-6989586621679097385"><a href="#local-6989586621679097385"><span class="hs-identifier">sheepsCs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Board.html#sheepsCoords"><span class="hs-identifier hs-var">sheepsCoords</span></a><span> </span><a href="#local-6989586621679097383"><span class="hs-identifier hs-var">brd</span></a><span></span><span>
</span><a name="line-124"></a><span>        </span><a name="local-6989586621679097386"><a href="#local-6989586621679097386"><span class="hs-identifier">noMoves</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Board.html#validWolfMoves"><span class="hs-identifier hs-var">validWolfMoves</span></a><span> </span><a href="#local-6989586621679097383"><span class="hs-identifier hs-var">brd</span></a><span></span><span>
</span><a name="line-125"></a><span>        </span><a name="local-6989586621679097387"><a href="#local-6989586621679097387"><span class="hs-identifier">distFromUpperEdge</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">abs</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ord</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679097384"><span class="hs-identifier hs-var">wolfC</span></a><span> </span><span class="hs-operator hs-var">!!</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier hs-var">ord</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pred</span><span> </span><span class="hs-char">'1'</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-126"></a><span>        </span><a name="local-6989586621679097388"><a href="#local-6989586621679097388"><span class="hs-identifier">wolfSheepsAvgDist</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sum</span><span> </span><span class="hs-special">(</span><a href="Board.Coordinate.html#distance"><span class="hs-identifier hs-var">distance</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679097384"><span class="hs-identifier hs-var">wolfC</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="#local-6989586621679097385"><span class="hs-identifier hs-var">sheepsCs</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679097385"><span class="hs-identifier hs-var">sheepsCs</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-127"></a><span>    </span><span class="hs-keyword">in</span><span>  </span><a href="#local-6989586621679097387"><span class="hs-identifier hs-var">distFromUpperEdge</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679097386"><span class="hs-identifier hs-var">noMoves</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679097388"><span class="hs-identifier hs-var">wolfSheepsAvgDist</span></a><span></span><span>
</span><a name="line-128"></a><span></span><span>
</span><a name="line-129"></a><span class="hs-comment">-- | Points that sheeps can use to rate their current situation in the game. Calculated as @-1 * 'wolfPoints'@. </span><span>
</span><a name="line-130"></a><span class="hs-identifier">sheepsPoints</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Board.html#Board"><span class="hs-identifier hs-type">Board</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span></span><span>
</span><a name="line-131"></a><a name="sheepsPoints"><a href="Board.html#sheepsPoints"><span class="hs-identifier">sheepsPoints</span></a></a><span> </span><a name="local-6989586621679097389"><a href="#local-6989586621679097389"><span class="hs-identifier">brd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="Board.html#wolfPoints"><span class="hs-identifier hs-var">wolfPoints</span></a><span> </span><a href="#local-6989586621679097389"><span class="hs-identifier hs-var">brd</span></a><span></span><span>
</span><a name="line-132"></a><span></span><span>
</span><a name="line-133"></a><span class="hs-comment">-- | From list of possible moves, return the best (the one that leads to the state of the board with biggest amount of points).</span><span>
</span><a name="line-134"></a><span class="hs-identifier">bestMove</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Board.html#Board"><span class="hs-identifier hs-type">Board</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- ^ A function used to rate the board state. May be either wolfPoints or sheepsPoints. </span><span>
</span><a name="line-135"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Board.html#Board"><span class="hs-identifier hs-type">Board</span></a><span>               </span><span class="hs-comment">-- ^ Current board state. </span><span>
</span><a name="line-136"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Move.html#Move"><span class="hs-identifier hs-type">Move</span></a><span class="hs-special">]</span><span>              </span><span class="hs-comment">-- ^ List of moves to analyze. May be empty, if no moves are possible (one side won the game). </span><span>
</span><a name="line-137"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Move.html#Move"><span class="hs-identifier hs-type">Move</span></a><span class="hs-special">,</span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ The best move, alogside with its rating. May be Nothing, if list of moves to analyze is empty. </span><span>
</span><a name="line-138"></a><a name="bestMove"><a href="Board.html#bestMove"><span class="hs-identifier">bestMove</span></a></a><span> </span><a name="local-6989586621679097390"><a href="#local-6989586621679097390"><span class="hs-identifier">points</span></a></a><span> </span><a name="local-6989586621679097391"><a href="#local-6989586621679097391"><span class="hs-identifier">brd</span></a></a><span> </span><a name="local-6989586621679097392"><a href="#local-6989586621679097392"><span class="hs-identifier">ms</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><a name="line-139"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679097393"><a href="#local-6989586621679097393"><span class="hs-identifier">moves</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679097394"><a href="#local-6989586621679097394"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097394"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679097390"><span class="hs-identifier hs-var">points</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097391"><span class="hs-identifier hs-var">brd</span></a><span> </span><a href="Board.html#%3E%3E%3E"><span class="hs-operator hs-var">&gt;&gt;&gt;</span></a><span> </span><a href="#local-6989586621679097394"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679097392"><span class="hs-identifier hs-var">ms</span></a><span></span><span>
</span><a name="line-140"></a><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679097393"><span class="hs-identifier hs-var">moves</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">foldl1'</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679097395"><a href="#local-6989586621679097395"><span class="hs-identifier">m1</span></a></a><span class="hs-special">,</span><a name="local-6989586621679097396"><a href="#local-6989586621679097396"><span class="hs-identifier">p1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679097397"><a href="#local-6989586621679097397"><span class="hs-identifier">m2</span></a></a><span class="hs-special">,</span><a name="local-6989586621679097398"><a href="#local-6989586621679097398"><span class="hs-identifier">p2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679097396"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-6989586621679097398"><span class="hs-identifier hs-var">p2</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097395"><span class="hs-identifier hs-var">m1</span></a><span class="hs-special">,</span><a href="#local-6989586621679097396"><span class="hs-identifier hs-var">p1</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097397"><span class="hs-identifier hs-var">m2</span></a><span class="hs-special">,</span><a href="#local-6989586621679097398"><span class="hs-identifier hs-var">p2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679097393"><span class="hs-identifier hs-var">moves</span></a><span></span><span>
</span><a name="line-141"></a><span></span><span>
</span><a name="line-142"></a><span class="hs-comment">-- | Auxiliary function, calculates the best wolf move on the current board state. Applies 'wolfPoints' and 'validWolfMoves' to bestMove. </span><span>
</span><a name="line-143"></a><span class="hs-comment">{-| TODO: add recursive analyze of game tree. -}</span><span></span><span>
</span><a name="line-144"></a><span class="hs-identifier">bestWolfMove</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>                 </span><span class="hs-comment">-- ^ Depth of game tree to analyze. </span><span>
</span><a name="line-145"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Board.html#Board"><span class="hs-identifier hs-type">Board</span></a><span>               </span><span class="hs-comment">-- ^ Current board state.</span><span>
</span><a name="line-146"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Move.html#Move"><span class="hs-identifier hs-type">Move</span></a><span class="hs-special">,</span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ The best wolf move, alogside with its rating. May be Nothing, if list of moves to analyze is empty. </span><span>
</span><a name="line-147"></a><a name="bestWolfMove"><a href="Board.html#bestWolfMove"><span class="hs-identifier">bestWolfMove</span></a></a><span> </span><span class="hs-number">0</span><span> </span><a name="local-6989586621679097399"><a href="#local-6989586621679097399"><span class="hs-identifier">brd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Board.html#bestMove"><span class="hs-identifier hs-var">bestMove</span></a><span> </span><a href="Board.html#wolfPoints"><span class="hs-identifier hs-var">wolfPoints</span></a><span> </span><a href="#local-6989586621679097399"><span class="hs-identifier hs-var">brd</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Board.html#validWolfMoves"><span class="hs-identifier hs-var">validWolfMoves</span></a><span> </span><a href="#local-6989586621679097399"><span class="hs-identifier hs-var">brd</span></a><span></span><span>
</span><a name="line-148"></a><span></span><span>
</span><a name="line-149"></a><span class="hs-comment">-- | Auxiliary function, calculates the best sheeps move on the current board state. Applies 'sheepsPoints' and 'validSheepsMoves' to bestMove. </span><span>
</span><a name="line-150"></a><span class="hs-comment">{-| TODO: add recursive analyze of game tree -}</span><span></span><span>
</span><a name="line-151"></a><span class="hs-identifier">bestSheepMove</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>                 </span><span class="hs-comment">-- ^ Depth of game tree to analyze. </span><span>
</span><a name="line-152"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Board.html#Board"><span class="hs-identifier hs-type">Board</span></a><span>               </span><span class="hs-comment">-- ^ Current board state. </span><span>
</span><a name="line-153"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Move.html#Move"><span class="hs-identifier hs-type">Move</span></a><span class="hs-special">,</span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ The best wolf move, alogside with its rating. May be Nothing, if list of moves to analyze is empty. </span><span>
</span><a name="line-154"></a><a name="bestSheepMove"><a href="Board.html#bestSheepMove"><span class="hs-identifier">bestSheepMove</span></a></a><span> </span><span class="hs-number">0</span><span> </span><a name="local-6989586621679097400"><a href="#local-6989586621679097400"><span class="hs-identifier">brd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Board.html#bestMove"><span class="hs-identifier hs-var">bestMove</span></a><span> </span><a href="Board.html#sheepsPoints"><span class="hs-identifier hs-var">sheepsPoints</span></a><span> </span><a href="#local-6989586621679097400"><span class="hs-identifier hs-var">brd</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Board.html#validSheepsMoves"><span class="hs-identifier hs-var">validSheepsMoves</span></a><span> </span><a href="#local-6989586621679097400"><span class="hs-identifier hs-var">brd</span></a><span></span><span>
</span><a name="line-155"></a><span></span><span>
</span><a name="line-156"></a><span class="hs-comment">-- | JSONize and save board to file</span><span>
</span><a name="line-157"></a><span class="hs-identifier">toFile</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Board.html#Board"><span class="hs-identifier hs-type">Board</span></a><span>  </span><span class="hs-comment">-- ^ Board state to save.</span><span>
</span><a name="line-158"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-comment">-- ^ File name. </span><span>
</span><a name="line-159"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-160"></a><span class="hs-comment">--toFile (Board b) fileName = ByteString.writeFile fileName $ encode (Map.toList b)</span><span>
</span><a name="line-161"></a><a name="toFile"><a href="Board.html#toFile"><span class="hs-identifier">toFile</span></a></a><span> </span><span class="hs-special">(</span><a href="Board.html#Board"><span class="hs-identifier hs-var">Board</span></a><span> </span><a name="local-6989586621679097401"><a href="#local-6989586621679097401"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679097402"><a href="#local-6989586621679097402"><span class="hs-identifier">fileName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span></span><span>
</span><a name="line-162"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679097403"><a href="#local-6989586621679097403"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">encode</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">toList</span><span> </span><a href="#local-6989586621679097401"><span class="hs-identifier hs-var">b</span></a><span></span><span>
</span><a name="line-163"></a><span>    </span><span class="hs-identifier hs-var">runConduitRes</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">sourceLazy</span><span> </span><a href="#local-6989586621679097403"><span class="hs-identifier hs-var">bs</span></a><span> </span><span class="hs-operator hs-var">.|</span><span> </span><span class="hs-identifier hs-var">sinkFile</span><span> </span><a href="#local-6989586621679097402"><span class="hs-identifier hs-var">fileName</span></a><span></span><span>
</span><a name="line-164"></a><span></span><span>
</span><a name="line-165"></a><span class="hs-comment">-- | Read board state from file</span><span>
</span><a name="line-166"></a><span class="hs-identifier">fromFile</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-comment">-- ^ File name. </span><span>
</span><a name="line-167"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="Board.html#Board"><span class="hs-identifier hs-type">Board</span></a><span></span><span>
</span><a name="line-168"></a><a name="fromFile"><a href="Board.html#fromFile"><span class="hs-identifier">fromFile</span></a></a><span> </span><a name="local-6989586621679097771"><a href="#local-6989586621679097771"><span class="hs-identifier">fileName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span></span><span>
</span><a name="line-169"></a><span>    </span><a name="local-6989586621679097772"><a href="#local-6989586621679097772"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">ByteString</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">readFile</span><span> </span><a href="#local-6989586621679097771"><span class="hs-identifier hs-var">fileName</span></a><span></span><span>
</span><a name="line-170"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679097773"><a href="#local-6989586621679097773"><span class="hs-identifier">bmap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromList</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fromJust</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">decode</span><span> </span><a href="#local-6989586621679097772"><span class="hs-identifier hs-var">bs</span></a><span></span><span>
</span><a name="line-171"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Board.html#Board"><span class="hs-identifier hs-var">Board</span></a><span> </span><a href="#local-6989586621679097773"><span class="hs-identifier hs-var">bmap</span></a><span></span><span>
</span><a name="line-172"></a><span></span><span>
</span><a name="line-173"></a></pre></body></html>