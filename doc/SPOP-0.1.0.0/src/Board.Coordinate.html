<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : Board.Coordinate
Description : Board fields coordinates
Datatype that contains valid coordinates of checkerboard fields. 
-}</span><span></span><span>
</span><a name="line-6"></a><span></span><span>
</span><a name="line-7"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Board</span><span class="hs-operator">.</span><span class="hs-identifier">Coordinate</span><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-8"></a><span></span><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Aeson</span><span></span><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Char</span><span></span><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">Generics</span><span></span><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span>           </span><a href="Move.Direction.html"><span class="hs-identifier">Move</span><span class="hs-operator">.</span><span class="hs-identifier">Direction</span></a><span></span><span>
</span><a name="line-13"></a><span></span><span>
</span><a name="line-14"></a><span class="hs-comment">-- | Checkerboard has 8x8 size. Only black fields are used, so there are total 32 valid board fields and its coordinates. Also, out of the board coordinate is added, as moving a wolf or sheep may sometimes result in getting out of the board edges. </span><span>
</span><a name="line-15"></a><span class="hs-keyword">data</span><span> </span><a name="Coordinate"><a href="Board.Coordinate.html#Coordinate"><span class="hs-identifier">Coordinate</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="A1"><a href="Board.Coordinate.html#A1"><span class="hs-identifier">A1</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="A3"><a href="Board.Coordinate.html#A3"><span class="hs-identifier">A3</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="A5"><a href="Board.Coordinate.html#A5"><span class="hs-identifier">A5</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="A7"><a href="Board.Coordinate.html#A7"><span class="hs-identifier">A7</span></a></a><span> </span><span class="hs-glyph">|</span><span></span><span>
</span><a name="line-16"></a><span>                  </span><a name="B2"><a href="Board.Coordinate.html#B2"><span class="hs-identifier">B2</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="B4"><a href="Board.Coordinate.html#B4"><span class="hs-identifier">B4</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="B6"><a href="Board.Coordinate.html#B6"><span class="hs-identifier">B6</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="B8"><a href="Board.Coordinate.html#B8"><span class="hs-identifier">B8</span></a></a><span> </span><span class="hs-glyph">|</span><span></span><span>
</span><a name="line-17"></a><span>                  </span><a name="C1"><a href="Board.Coordinate.html#C1"><span class="hs-identifier">C1</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="C3"><a href="Board.Coordinate.html#C3"><span class="hs-identifier">C3</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="C5"><a href="Board.Coordinate.html#C5"><span class="hs-identifier">C5</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="C7"><a href="Board.Coordinate.html#C7"><span class="hs-identifier">C7</span></a></a><span> </span><span class="hs-glyph">|</span><span></span><span>
</span><a name="line-18"></a><span>                  </span><a name="D2"><a href="Board.Coordinate.html#D2"><span class="hs-identifier">D2</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="D4"><a href="Board.Coordinate.html#D4"><span class="hs-identifier">D4</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="D6"><a href="Board.Coordinate.html#D6"><span class="hs-identifier">D6</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="D8"><a href="Board.Coordinate.html#D8"><span class="hs-identifier">D8</span></a></a><span> </span><span class="hs-glyph">|</span><span></span><span>
</span><a name="line-19"></a><span>                  </span><a name="E1"><a href="Board.Coordinate.html#E1"><span class="hs-identifier">E1</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="E3"><a href="Board.Coordinate.html#E3"><span class="hs-identifier">E3</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="E5"><a href="Board.Coordinate.html#E5"><span class="hs-identifier">E5</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="E7"><a href="Board.Coordinate.html#E7"><span class="hs-identifier">E7</span></a></a><span> </span><span class="hs-glyph">|</span><span></span><span>
</span><a name="line-20"></a><span>                  </span><a name="F2"><a href="Board.Coordinate.html#F2"><span class="hs-identifier">F2</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="F4"><a href="Board.Coordinate.html#F4"><span class="hs-identifier">F4</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="F6"><a href="Board.Coordinate.html#F6"><span class="hs-identifier">F6</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="F8"><a href="Board.Coordinate.html#F8"><span class="hs-identifier">F8</span></a></a><span> </span><span class="hs-glyph">|</span><span></span><span>
</span><a name="line-21"></a><span>                  </span><a name="G1"><a href="Board.Coordinate.html#G1"><span class="hs-identifier">G1</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="G3"><a href="Board.Coordinate.html#G3"><span class="hs-identifier">G3</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="G5"><a href="Board.Coordinate.html#G5"><span class="hs-identifier">G5</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="G7"><a href="Board.Coordinate.html#G7"><span class="hs-identifier">G7</span></a></a><span> </span><span class="hs-glyph">|</span><span></span><span>
</span><a name="line-22"></a><span>                  </span><a name="H2"><a href="Board.Coordinate.html#H2"><span class="hs-identifier">H2</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="H4"><a href="Board.Coordinate.html#H4"><span class="hs-identifier">H4</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="H6"><a href="Board.Coordinate.html#H6"><span class="hs-identifier">H6</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="H8"><a href="Board.Coordinate.html#H8"><span class="hs-identifier">H8</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="OutOfBoard"><a href="Board.Coordinate.html#OutOfBoard"><span class="hs-identifier">OutOfBoard</span></a></a><span></span><span>
</span><a name="line-23"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Enum</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-24"></a><span></span><span>
</span><a name="line-25"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span> </span><a href="Board.Coordinate.html#Coordinate"><span class="hs-identifier hs-type">Coordinate</span></a><span></span><span>
</span><a name="line-26"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToJSON</span><span> </span><a href="Board.Coordinate.html#Coordinate"><span class="hs-identifier hs-type">Coordinate</span></a><span></span><span>
</span><a name="line-27"></a><span></span><span>
</span><a name="line-28"></a><span class="hs-comment">-- | Calculate a new coordinate, after executing a move in specified direction. </span><span>
</span><a name="line-29"></a><span class="hs-identifier">move</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Board.Coordinate.html#Coordinate"><span class="hs-identifier hs-type">Coordinate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Move.Direction.html#Direction"><span class="hs-identifier hs-type">Direction</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Board.Coordinate.html#Coordinate"><span class="hs-identifier hs-type">Coordinate</span></a><span></span><span>
</span><a name="line-30"></a><a name="local-6989586621679084137"><a href="#local-6989586621679084137"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-special">`</span><a name="move"><a href="Board.Coordinate.html#move"><span class="hs-identifier">move</span></a></a><span class="hs-special">`</span><span> </span><a name="local-6989586621679084138"><a href="#local-6989586621679084138"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><a name="line-31"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679084139"><a href="#local-6989586621679084139"><span class="hs-identifier">char</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679084137"><span class="hs-identifier hs-var">c</span></a><span></span><span>
</span><a name="line-32"></a><span>        </span><a name="local-6989586621679084140"><a href="#local-6989586621679084140"><span class="hs-identifier">int</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679084137"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">!!</span><span> </span><span class="hs-number">1</span><span></span><span>
</span><a name="line-33"></a><span>        </span><a name="local-6989586621679084141"><a href="#local-6989586621679084141"><span class="hs-identifier">char2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="Move.Direction.html#haxis"><span class="hs-identifier hs-var">haxis</span></a><span> </span><a href="#local-6989586621679084138"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Move.Direction.html#Left"><span class="hs-identifier hs-var">Move</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">Direction</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">Left</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">pred</span><span> </span><a href="#local-6989586621679084139"><span class="hs-identifier hs-var">char</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">succ</span><span> </span><a href="#local-6989586621679084139"><span class="hs-identifier hs-var">char</span></a><span></span><span>
</span><a name="line-34"></a><span>        </span><a name="local-6989586621679084142"><a href="#local-6989586621679084142"><span class="hs-identifier">int2</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="Move.Direction.html#vaxis"><span class="hs-identifier hs-var">vaxis</span></a><span> </span><a href="#local-6989586621679084138"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Move.Direction.html#Up"><span class="hs-identifier hs-var">Move</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">Direction</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">Up</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">pred</span><span> </span><a href="#local-6989586621679084140"><span class="hs-identifier hs-var">int</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">succ</span><span> </span><a href="#local-6989586621679084140"><span class="hs-identifier hs-var">int</span></a><span></span><span>
</span><a name="line-35"></a><span>        </span><a name="local-6989586621679084143"><a href="#local-6989586621679084143"><span class="hs-identifier">code2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679084141"><span class="hs-identifier hs-var">char2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679084142"><span class="hs-identifier hs-var">int2</span></a><span class="hs-special">]</span><span></span><span>
</span><a name="line-36"></a><span>        </span><a name="local-6989586621679084144"><a href="#local-6989586621679084144"><span class="hs-identifier">validCodes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">[</span><a href="Board.Coordinate.html#A1"><span class="hs-identifier hs-var">A1</span></a><span> </span><span class="hs-glyph">..</span><span> </span><a href="Board.Coordinate.html#H8"><span class="hs-identifier hs-var">H8</span></a><span class="hs-special">]</span><span></span><span>
</span><a name="line-37"></a><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679084143"><span class="hs-identifier hs-var">code2</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">notElem</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679084144"><span class="hs-identifier hs-var">validCodes</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="Board.Coordinate.html#OutOfBoard"><span class="hs-identifier hs-var">OutOfBoard</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">read</span><span> </span><a href="#local-6989586621679084143"><span class="hs-identifier hs-var">code2</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Board.Coordinate.html#Coordinate"><span class="hs-identifier hs-type">Coordinate</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-38"></a><span></span><span>
</span><a name="line-39"></a><span class="hs-comment">-- | Infix equivalent of 'move'. </span><span>
</span><a name="line-40"></a><span class="hs-special">(</span><span class="hs-operator">|&gt;&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Board.Coordinate.html#Coordinate"><span class="hs-identifier hs-type">Coordinate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Move.Direction.html#Direction"><span class="hs-identifier hs-type">Direction</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Board.Coordinate.html#Coordinate"><span class="hs-identifier hs-type">Coordinate</span></a><span></span><span>
</span><a name="line-41"></a><span class="hs-special">(</span><a name="%7C%3E%3E"><a href="Board.Coordinate.html#%7C%3E%3E"><span class="hs-operator">|&gt;&gt;</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Board.Coordinate.html#move"><span class="hs-identifier hs-var">move</span></a><span></span><span>
</span><a name="line-42"></a><span></span><span>
</span><a name="line-43"></a><span class="hs-comment">-- | Calculate euclidean distance between two fields. </span><span>
</span><a name="line-44"></a><span class="hs-identifier">distance</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Board.Coordinate.html#Coordinate"><span class="hs-identifier hs-type">Coordinate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Board.Coordinate.html#Coordinate"><span class="hs-identifier hs-type">Coordinate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span></span><span>
</span><a name="line-45"></a><a name="distance"><a href="Board.Coordinate.html#distance"><span class="hs-identifier">distance</span></a></a><span> </span><a name="local-6989586621679085288"><a href="#local-6989586621679085288"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-6989586621679085289"><a href="#local-6989586621679085289"><span class="hs-identifier">c2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><a name="line-46"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679085290"><a href="#local-6989586621679085290"><span class="hs-identifier">x1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ord</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679085288"><span class="hs-identifier hs-var">c1</span></a><span></span><span>
</span><a name="line-47"></a><span>        </span><a name="local-6989586621679085291"><a href="#local-6989586621679085291"><span class="hs-identifier">y1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ord</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679085288"><span class="hs-identifier hs-var">c1</span></a><span> </span><span class="hs-operator hs-var">!!</span><span> </span><span class="hs-number">1</span><span></span><span>
</span><a name="line-48"></a><span>        </span><a name="local-6989586621679085292"><a href="#local-6989586621679085292"><span class="hs-identifier">x2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ord</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679085289"><span class="hs-identifier hs-var">c2</span></a><span></span><span>
</span><a name="line-49"></a><span>        </span><a name="local-6989586621679085293"><a href="#local-6989586621679085293"><span class="hs-identifier">y2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ord</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679085289"><span class="hs-identifier hs-var">c2</span></a><span> </span><span class="hs-operator hs-var">!!</span><span> </span><span class="hs-number">1</span><span></span><span>
</span><a name="line-50"></a><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">sqrt</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679085292"><span class="hs-identifier hs-var">x2</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679085290"><span class="hs-identifier hs-var">x1</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">**</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679085293"><span class="hs-identifier hs-var">y2</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679085291"><span class="hs-identifier hs-var">y1</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">**</span><span> </span><span class="hs-number">2</span><span></span><span>
</span><a name="line-51"></a><span></span><span>
</span><a name="line-52"></a></pre></body></html>